funpackFitsFiles('2023-05-24 18:07:20', '2023-05-24 18:20:40','/last10w/data1/archive/LAST.01.10.03/', '~/Documents/to_delete/')





XYshift = [

           1           1
           1        1601
           1        3201
           1        4801
           1        6401
           1        8001
        1606           1
        1606        1601
        1606        3201
        1606        4801
        1606        6401
        1606        8001
        3212           1
        3212        1601
        3212        3201
        3212        4801
        3212        6401
        3212        8001
        4817           1
        4817        1601
        4817        3201
        4817        4801
        4817        6401
        4817        8001
];


XYshift =[

           1           1
           1        1590
           1        3190
           1        4790
           1        6390
           1        7974
        1595           1
        1595        1590
        1595        3190
        1595        4790
        1595        6390
        1595        7974
        3201           1
        3201        1590
        3201        3190
        3201        4790
        3201        6390
        3201        7974
        4796           1
        4796        1590
        4796        3190
        4796        4790
        4796        6390
        4796        7974];

%%





%%
Cropshift = XYshift(14,:);
   
  XY=[ 


       446.89         1557
       446.59       1556.7
        446.3       1556.2
       445.99       1556.2
       445.87       1555.7
       445.81       1555.6
       445.21       1555.1
       444.98       1555.2
        444.6       1554.8
       444.07       1554.6
       443.24       1553.9
       443.68       1554.2
       443.51       1553.8
       443.71       1553.6
       443.24       1554.2
       442.93       1553.2
       442.89       1553.1
       442.67       1552.5
        442.6       1552.1
       441.78       1553.2
       441.96       1552.4
       441.99         1551
       441.46       1551.6
       441.67       1550.3
       441.19       1550.5
       441.03       1549.7
       440.67       1549.9
       440.36         1550
       440.18       1549.6
       440.61       1549.4
        439.6       1549.4
       439.31       1549.5
       439.15       1549.4
       438.84         1549
       438.64       1547.8
        438.3       1547.6
       438.05       1548.1
       438.15       1547.3
          437.09       1547.3
       437.09       1547.3];


%%
    xy = zeros(size(XY));
    
    for i = 1 : height(XY)
        
      xy(i,1) = XY(i,1) +3212 - 64 -16 - 1;
      xy(i,2) = XY(i,2) +1601 - 32 -16 +1;
        
    end
    
    
    
%%
loadFitsInDS9a('~/Documents/to_delete/','x',[xy(:,1)],'y',[xy(:,2)],'radius',5)



%%
cd('~/Documents/to_delete/')

AI = AstroImage('LAST.01.10.03_20230524.180735.000_clear_161+52_041_001_001_sci_raw_Image_1.fits', 'HDU',1)
Args.BlockSize                        = [1600 1600];  % empty - full image
Args.OverlapXY                        = [64 64];


 [SI, InfoCCDSEC] = imProc.image.image2subimages(AI, Args.BlockSize)%, 'UpdateCat',false,...
                                                                        {},...
                                                                        'OverlapXY',Args.OverlapXY,...
                                                                        'UpdateWCS',false,...
                                                                        'UpdatePSF',false);





