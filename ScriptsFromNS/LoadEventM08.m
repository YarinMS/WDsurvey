%
funpackFitsFiles('2022-12-05 02:36:25', '2022-12-05 02:49:50','/last08e/data2/archive/LAST.01.08.02/', '~/Documents/tounpack/')




XYshift = [

           1           1
           1        1601
           1        3201
           1        4801
           1        6401
           1        8001
        1606           1
        1606        1601
        1606        3201
        1606        4801
        1606        6401
        1606        8001
        3212           1
        3212        1601
        3212        3201
        3212        4801
        3212        6401
        3212        8001
        4817           1
        4817        1601
        4817        3201
        4817        4801
        4817        6401
        4817        8001
];

%%





AI = AstroImage('LAST.01.08.02_20221205.023627.842_clear_125+22_021_001_001_sci_raw_Image_1.fits', 'HDU',1)
Args.BlockSize                        = [1600 1600];  % empty - full image
Args.OverlapXY                        = [64 64];


 [SI, InfoCCDSEC] = imProc.image.image2subimages(AI, Args.BlockSize)%, 'UpdateCat',false,...
                                                                        {},...
                                                                        'OverlapXY',Args.OverlapXY,...
                                                                        'UpdateWCS',false,...
                                                                        'UpdatePSF',false);





    
   %%
   Cropshift = XYshift(10,:);
   
  XY=[  235.74       1455.3
       235.51       1455.4
       235.52       1455.8
       235.32         1456
       235.14       1456.3
       235.08       1456.6
       234.93       1456.7
       234.82         1457
       234.55       1457.2
       234.49       1457.5
       234.24       1457.8
       234.08         1458
       233.77       1458.3
       233.63       1458.8
       233.67       1458.7
        233.6       1459.1
       233.31       1459.2
       233.04       1459.4
       233.07       1459.6
       232.76       1459.8
       232.97       1459.9
       232.87       1460.4
       232.28       1461.9
       232.13       1462.3
       232.07       1462.5
       232.02       1462.9
       231.77       1463.1
       231.71       1463.2
       231.47       1463.4
       231.07       1463.6
       230.99       1463.8
       230.93       1463.8
       230.76         1464
       230.44       1464.3
       230.34       1464.5
       230.19       1464.6
       230.04       1464.8
       230.06       1465.2
       229.81       1465.6
        229.6       1465.9];

    
    
    %%
    xy = zeros(size(XY));
    
    for i = 1 : height(XY)
        
      xy(i,1) = XY(i,1) +Cropshift(1)-81;
      xy(i,2) = XY(i,2) +Cropshift(2)-47;
        
    end
    
    
    
%%
loadFitsInDS9a('~/Documents/tounpack/','x',[xy(:,1)],'y',[xy(:,2)],'radius',5)

